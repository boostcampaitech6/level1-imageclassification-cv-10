# â­ CV 10íŒ€ ì†Œê°œ 

![ì˜-ì°¨ ì˜-ì°¨ (1)](https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/67350632/098b274b-42d1-4759-aa26-8f130c029330)
<br/>

> ### ğŸƒ ë©¤ë²„
<table>
    <tr height="160px">
        <td align="center" width="150px">
            <a href="https://github.com/FinalCold"><img height="120px" width="120px" src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/4c47db91-cf83-473c-888f-75d3a5573ac8"></a>
            <br/>
            <a href="https://github.com/FinalCold"><strong>ë°•ì°¬ì¢…</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/woohee-yang"><img height="120px" width="120px" src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/0548b5bf-d3f5-4c9e-a7e5-c2733bc48355"/></a>
            <br/>
            <a href="https://github.com/woohee-yang"><strong>ì–‘ìš°í¬</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/lukehanjun"><img height="120px" width="120px" src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/bfb37916-ed9e-405c-a981-70c0fdaa53be"/></a>
            <br/>
            <a href="https://github.com/lukehanjun"><strong>ìœ í•œì¤€</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/jinida"><img height="120px" width="120px" src=https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/d3891701-98db-4382-abc0-3a0ab64e976e"/></a>
            <br />
            <a href="https://github.com/jinida"><strong>ì´ì˜ì§„</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
            <a href="https://github.com/soyoonjeong"><img height="120px" width="120px" src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/912e24ed-cc51-49ab-90fd-24ef0df7ce0b"/></a>
            <br />
            <a href="https://github.com/soyoonjeong"><strong>ì •ì†Œìœ¤</strong></a>
            <br />
        </td>
        <td align="center" width="150px">
              <a href="https://github.com/classaen7"><img height="120px" width="120px" src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/d5fc34c5-dfd2-400e-86d5-b32976aeb928"/></a>
              <br />
              <a href="https://github.com/classaen7"><strong>ìµœì‹œí˜„</strong></a>
              <br />
          </td>
    </tr>
</table>  
<br/><br/><br/>

# ğŸ˜· ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœ ë¶„ë¥˜ ëŒ€íšŒ
> ### ğŸ† ëŒ€íšŒê°œìš”
- `Multi Label Image Classification`
- `ë§ˆìŠ¤í¬ë¥¼ ì“°ê±°ë‚˜ ì“°ì§€ ì•Šì€ ì•„ì‹œì•„ì¸ë“¤ì˜ ì–¼êµ´ ì‚¬ì§„ì„ ë³´ê³  ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœì™€ ì„±ë³„, ì—°ë ¹ëŒ€ë¥¼ ì¶”ë¡ í•˜ëŠ” ë¬¸ì œ`

<br/>
> ### ğŸ‘©â€ğŸ’» íŒ€ ì—­í• 
|ì´ë¦„|ì—­í• |
|------|---|
|ë°•ì°¬ì¢…|í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì‹¤í—˜, ë°ì´í„° ì¦ê°• ì‹¤í—˜, ì‹±ê¸€ ë° ë©€í‹° í—¤ë“œ ì‹¤í—˜, ì½”ë“œ ë¬¸ì„œí™”|
|ì–‘ìš°í¬|ì‹±ê¸€ ë° ë©€í‹°í—¤ë“œ, ì•™ìƒë¸” ëª¨ë¸ ì‹¤í—˜, github ê´€ë¦¬, ì½”ë“œ ë¬¸ì„œí™”|
|ìœ í•œì¤€|ë°ì´í„° ì¦ê°• ì‹¤í—˜, ì‹±ê¸€ ëª¨ë¸ ì‹¤í—˜|
|ì´ì˜ì§„|ë°ì´í„° ì¦ê°•, í´ë˜ìŠ¤ ë³„ ëª¨ë¸ í•™ìŠµ, ì†ì‹¤í•¨ìˆ˜ ì‹¤í—˜, ì½”ë“œ ë¦¬íŒ©í† ë§|
|ì •ì†Œìœ¤|ë°ì´í„° ì „ì²˜ë¦¬, ì‹±ê¸€ ë° ë©€í‹° í—¤ë“œ ëª¨ë¸ ì‹¤í—˜|
|ìµœì‹œí˜„|ë°ì´í„° ì „ì²˜ë¦¬(ë°°ê²½ ì œê±°, ì–¼êµ´ íƒì§€) ì‹¤í—˜|


<br/>
> ### â° WBS
<img src="https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/7dc7c21d-d41c-4b28-907e-4e9a88543c44">
<a href="https://docs.google.com/spreadsheets/d/14qhqnSzOfvZsKYnmQyikYhVdpoUNx1-tdBY_Zkixy9c/edit#gid=0"> ğŸ“ WBS</a>
<br/><br/><br/>

> ### ğŸ’» ê°œë°œ í™˜ê²½
```bash
- Language : Python
- Environment
  - CPU : Intel(R) Xeon(R) Gold 5120
  - GPU : Tesla V100-SXM2 32GB Ã— 1
- Framework : PyTorch
- Collaborative Tool : Git, Wandb, Notion
```
<br/><br/><br/>
> ### ğŸ”¥ í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
---
``` bash
pip install -r requirements.txt
```
<br/>

> ### ğŸ’½ Dataset
- ì´ ì‚¬ì§„ ê°œìˆ˜ :  31500ì¥ 
- ì›ë³¸ ì´ë¯¸ì§€ í¬ê¸° : (512, 384)
- Label : ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœ, ì„±ë³„, ì—°ë ¹ëŒ€
- ë§ˆìŠ¤í¬ ì°©ìš© ìƒíƒœ (3 classes): ì •ìƒ ì°©ìš©, ë¹„ì •ìƒ ì°©ìš©, ë¯¸ì°©ìš©
- ì„±ë³„ (2 classes): ë‚¨ì„±, ì—¬ì„±
- ì—°ë ¹ëŒ€ (3 classes): 30ëŒ€ ì´í•˜, 30ëŒ€ ì´ìƒ 60ëŒ€ ë¯¸ë§Œ, 60ëŒ€ ì´ìƒ

<br/>

> ### ğŸ“Š EDA
<p align = "center">
<img height="300px" width="500px" src = "https://github.com/boostcampaitech6/level1-imageclassification-cv-10/assets/76814748/a5319723-0254-4b4a-9b68-74035e965f9a">
<p/>

- maskì™€ genderì— ëŒ€í•œ class imbalanceë„ ìˆì—ˆì§€ë§Œ, ë‘ ë ˆì´ë¸”ì— ëŒ€í•´ ê°ê° single modelì„  ì‹¤í—˜í•œ ê²°ê³¼ê°€ ì¢‹ì•˜ê¸° ë•Œë¬¸ì— ê°€ì¥ ë¬¸ì œê°€ ëœ ë ˆì´ë¸”ì€ age ì˜€ìŒ
- ì´ 3ê°€ì§€ í´ë˜ìŠ¤ì— ëŒ€í•´ ë¶„ì„í•œ ê²°ê³¼, 60ëŒ€ ì´ìƒì˜ ë°ì´í„°ê°€ ê°€ì¥ ì ì–´ augmentationì´ ê¼­ í•„ìš”í•œ ê²ƒìœ¼ë¡œ ë³´ì˜€ìŒ
- ë˜í•œ, 50ëŒ€ í›„ë°˜ ë°ì´í„°ê°€ 60ëŒ€ ë°ì´í„°ì— ë¹„í•´ ë„ˆë¬´ ë§ì•„ ì„œë¡œë¥¼ êµ¬ë³„í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 57-59ì„¸ ë°ì´í„°ëŠ” ì„ì˜ë¡œ ì œê±°í•˜ê¸°ë¡œ í•¨. ë™ì¼í•˜ê²Œ 20ëŒ€ í›„ë°˜ ë°ì´í„°ë„ 30ëŒ€ ì´ˆë°˜ê³¼ í˜¼ë™í•  ê°€ëŠ¥ì„±ì´ ìˆì–´ 28-29ì„¸ë¥¼ ì œê±°í•˜ì˜€ìŒ
- 20ëŒ€ì™€ 30ëŒ€ë¥¼ ê²°ì •ì§€ì„ ìˆ˜ ìˆëŠ” 30ëŒ€ ì´ˆë°˜ì˜ ë‚¨ì„± ë°ì´í„°ê°€ ê·¹ë„ë¡œ ì ê¸° ë•Œë¬¸ì— ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œë„ augmentationì„ ì§„í–‰í•˜ê¸°ë¡œ í•¨

<br/><br/>
> ### ğŸš€ Model
```bash
ìµœì¢… ëª¨ë¸ : Multi Task Model + Hard voting ensemble
```
1) **`Mask Model`** : Autoaugmentation + EfficientnetV2m + CrossEntropy
 - ë‹¤ì–‘í•œ Augmentation ê¸°ë²•ì„ ì‹¤í—˜í–ˆì§€ë§Œ, ì˜ˆìƒê³¼ëŠ” ë‹¤ë¥´ê²Œ ë¶„í• ëœ ë°ì´í„°ì…‹ì—ì„œ ì„±ëŠ¥ì˜ ì°¨ì´ê°€ í¬ê²Œ ë‚˜íƒ€ë‚¬ìŒ. ê·¸ì— ë”°ë¼ ìƒëŒ€ì ìœ¼ë¡œ ê°€ì¥ ê°•ì¸í•œ íš¨ê³¼ë¥¼ ë³´ì¸ Autoaugmentationì„ ì±„íƒí•˜ê²Œ ë˜ì—ˆìŒ
 - ì†ì‹¤ í•¨ìˆ˜ë„ ìƒê¸° ì´ìœ ë¡œ Cross Entropyë¥¼ ì±„íƒí•˜ì—¬ í•™ìŠµí•˜ì˜€ìŒ.
2) **`Gender Model`** : Autoaugmentation + EfficientnetV2m + ì…ë ¥ ì‚¬ì´ì¦ˆ [384, 288] +  Focal loss + AdamW + Cosine Scheduler
- ì„±ë³„ ë¶„ë¥˜ ëª¨ë¸ì€ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì•˜ë˜ EfficientNetV2m Backboneì— AutoAugmentationì„ ì ìš©í•œ ëª¨ë¸ì„ ìµœì¢… ì„ íƒí•¨
- ë‹¤ì–‘í•œ ì…ë ¥ ì‚¬ì´ì¦ˆë¡œ ì‹¤í—˜í•œ ê²°ê³¼ Â½ì›ë³¸ í¬ê¸°ì—ì„œ ê°€ì¥ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ì–´ ì±„íƒí•¨
- ì´ì™¸ì— augmentation ê¸°ë²•ë“¤ ì¤‘ Autoaugmentation ì™¸ì—ëŠ” ì˜¤íˆë ¤ ë‚®ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ì—ˆìŒ
3) **`Age Model`** : Custom data augmentation + Custom Mixup to 30s male, 60s + EfficientnetV2m + Hard-voting ensemble
 - ë‹¤ë¥¸ ë¶„ë¥˜ ë¬¸ì œë³´ë‹¤ í´ë˜ìŠ¤ ë¶ˆê· í˜•ì´ ì‹¬í•˜ì—¬ ì´ë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ ì—¬ëŸ¬ê°€ì§€ ê¸°ë²•ì„ ì‚¬ìš©í•¨.
 - Augmentation ë° LossëŠ” e)ì˜ ì‹¤í—˜ì—ì„œ ê°€ì¥ ì¢‹ì€ íš¨ê³¼ê°€ ë‚˜ì˜¨ AutoAugmentation, FocalWithSmootingë“±ì„ ì‚¬ìš©í•˜ì˜€ìŒ.
 ê·¸ ì™¸ ê¸°ë²•ìœ¼ë¡œ 30~59 / 60~ ë‘ í´ë˜ìŠ¤ì˜ êµ¬ë¶„ì„ ëšœë ·í•˜ê²Œ í•˜ê¸°ìœ„í•´ drop ageì„ ì ìš©í•¨.
 - ë˜í•œ ë°ì´í„°ê°€ ì ì€ 30ëŒ€ì˜ ë‚¨ì ë° 60ëŒ€ ì´ìƒì— ëŒ€í•´ì„œ mixupì„ ì‚¬ìš©í•˜ì—¬ offline augmentationì„ ì§„í–‰í•¨.
 - ë§ˆì§€ë§‰ìœ¼ë¡œ ë°ì´í„° ë³„ ì„±ëŠ¥ í¸ì°¨ê°€ ìˆìœ¼ë¯€ë¡œ 8:2ë¡œ ë‚˜ëˆˆ ë°ì´í„° ì…‹ë“¤ì— ëŒ€í•´ ê°ê°ì˜ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³  ìµœì¢…ìœ¼ë¡œ ë‚˜ì˜¨ ëª¨ë¸ë“¤ì— ëŒ€í•´ì„œ Hard-Votingì„ ì§„í–‰í•¨.

<br/><br/>
> ### ğŸ‹ Training
config í´ë” ì•ˆ <a href = "https://github.com/boostcampaitech6/level1-imageclassification-cv-10/blob/main/config/base.yml">yaml íŒŒì¼</a>ì—ì„œ training í™˜ê²½ ì¡°ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. 
 - Mask Model
```bash
python single_train.py --exp-name <ì´ë¦„> --dataset OnlyMaskDataset --model EfficientNetV2m --criterion cross_entropy --augmentation AutoAugmentation
```
- Gender Model
```bash
python single_train.py --exp-name <ì´ë¦„> --dataset OnlyGenderDataset --model EfficientNetV2m --criterion focal --augmentation AutoAugmentation --optimizer AdamW --schedular cosine
```
- Age Model 
train í•˜ê¸° ì´ì „ì— ë°ì´í„°ê°€ ì ì€ 30ëŒ€ ë‚¨ì ë° 60ëŒ€ ì´ìƒì— ëŒ€í•´ì„œ offline mixup augmentationì„ ì§„í–‰
```bash
python single_train.py --exp-name <ì´ë¦„> --dataset OnlyMaskDataset --model EfficientNetV2m --criterion focal --age-drop True  
```
<br/><br/>

> ### ğŸ” Inference
ê° labelì— ëŒ€í•œ Modelì„ Hard Voting ensemble ì§„í–‰ 
inference_3m íŒŒì¼ì˜ mask_model, gender_model, age_model ë³€ìˆ˜ë¥¼ ìˆ˜ì • í›„ 
```bash
python single_inference.py 
```
<br/><br/>
> ### ğŸ“‚ File Tree
```bash
  ğŸ“¦level1-imageclassification-cv-10
 â”£ ğŸ“‚EDA
 â”ƒ â”— ğŸ“œeda.ipynb
 â”£ ğŸ“‚config
 â”ƒ â”— ğŸ“œbase.yml
 â”£ ğŸ“‚data
 â”ƒ â”£ ğŸ“œaugmentation.py
 â”ƒ â”£ ğŸ“œdataloader.py
 â”ƒ â”£ ğŸ“œdatasets.py
 â”£ ğŸ“‚model
 â”ƒ â”— ğŸ“œmodel.py
 â”£ ğŸ“‚utils
 â”ƒ â”£ ğŸ“œargparsers.py
 â”ƒ â”£ ğŸ“œcombine_image_folder.py
 â”ƒ â”£ ğŸ“œevaluation.py
 â”ƒ â”£ ğŸ“œhpo.py
 â”ƒ â”£ ğŸ“œimg_preprocess.py
 â”ƒ â”£ ğŸ“œlogger.py
 â”ƒ â”£ ğŸ“œloss.py
 â”ƒ â”£ ğŸ“œlr_scheduler.py
 â”ƒ â”£ ğŸ“œmetric.py
 â”ƒ â”£ ğŸ“œplot.py
 â”ƒ â”£ ğŸ“œtrain_val_split.py
 â”ƒ â”£ ğŸ“œdata_split.py  
 â”ƒ â”£ ğŸ“œutil.py
 â”ƒ â”— ğŸ“œyolov8n-face.pt
 â”£ ğŸ“œsingle_inference.py
 â”£ ğŸ“œmulti_inference.py
 â”£ ğŸ“œsingle_train.py
 â”£ ğŸ“œmulti_train.py
 â”£ ğŸ“œvoting.py
 â”£ ğŸ“œrequirements.txt
 â”— ğŸ“œREADME.md

``` 


